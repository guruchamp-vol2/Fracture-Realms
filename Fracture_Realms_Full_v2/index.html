<!-- Fracture_Realms_Full_v2/index.html ‚Äî FULL FILE REPLACE -->

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Fracture Realms</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>

  <!-- Menu Scene -->
  <div id="menu" class="scene active">
    <div class="card wide">
      <h1>‚öîÔ∏è Fracture Realms</h1>
      <p class="subtitle">A fast-paced action platformer with gravity flips, time warps, and epic boss battles.</p>
      
      <div class="controls-section">
        <h3>üéÆ Controls</h3>
        <div class="controls-grid">
          <div class="control-item"><kbd>A</kbd> <kbd>D</kbd> Move</div>
          <div class="control-item"><kbd>W</kbd> Jump (double)</div>
          <div class="control-item"><kbd>J</kbd> Melee Attack</div>
          <div class="control-item"><kbd>K</kbd> Magic Attack</div>
          <div class="control-item"><kbd>L</kbd> Dash</div>
          <div class="control-item"><kbd>E</kbd> Grapple</div>
          <div class="control-item"><kbd>U</kbd> Upgrades</div>
          <div class="control-item"><kbd>P</kbd> Pause</div>
        </div>
        <p class="tip">üí° Gamepad supported: Left Stick + A/B/X/Y buttons</p>
      </div>

      <div class="features-section">
        <h3>‚ú® Features</h3>
        <ul>
          <li>8 unique worlds with distinct themes and modifiers</li>
          <li>4 challenging bosses with unique mechanics</li>
          <li>Upgradeable abilities and combat styles</li>
          <li>Dynamic gravity flips and time manipulation</li>
          <li>Autosave progression in localStorage</li>
        </ul>
      </div>

      <div class="game-modes">
        <button id="btnStartGame" class="btn primary large" onclick="console.log('Button clicked!'); if(window.startGame) window.startGame(); else alert('startGame not found!');">Start Single Player</button>
        <button id="btnCreateRoom" class="btn success large" onclick="if(window.createRoom) window.createRoom(); else alert('createRoom not found!');">Create Online Room</button>
        <button id="btnJoinRoom" class="btn warning large" onclick="if(window.joinRoom) window.joinRoom(); else alert('joinRoom not found!');">Join Online Room</button>
      </div>
      
      <!-- Room Code Display -->
      <div id="roomCode" class="room-code hidden">
        <h3>Room Code</h3>
        <div id="roomCodeValue" class="room-code-value"></div>
        <button id="btnCopyRoomCode" class="btn ghost">Copy Code</button>
      </div>
      
      <!-- Online Players Display -->
      <div id="onlinePlayers" class="online-players hidden">
        <h3>Online Players</h3>
        <div id="playersList" class="players-list"></div>
      </div>
    </div>
  </div>

  <canvas id="game" aria-label="Fracture Realms canvas"></canvas>
  
  <!-- Debug overlay - REMOVED -->

  <!-- Top HUD Chips -->
  <div id="hud" class="ui hidden">
    <div class="chips">
      <span id="chipRealm" class="chip">Realm: ‚Äî</span>
      <span id="chipGrav" class="chip">Gravity: ‚Üì</span>
      <span id="chipWarp" class="chip">Time Warp: 1.00√ó</span>
      <span id="chipCombo" class="chip">Combo: 0</span>
      <span id="chipShards" class="chip">Shards: 0</span>
      <span id="chipBoss" class="chip">Boss: ‚Äî</span>
    </div>
    <div class="actions">
      <button id="btnPause" class="btn primary" onclick="console.log('Pause inline click!'); if(window.game) window.game.togglePause();">Pause ‚ñå‚ñå</button>
    </div>
  </div>

  <!-- Pause Menu -->
  <div id="pauseMenu" class="overlay hidden" role="dialog" aria-modal="true" aria-labelledby="pauseTitle">
    <div class="panel">
      <h2 id="pauseTitle">Paused</h2>
      <div class="grid">
        <button id="btnResume" class="btn success">Resume ‚ñ∂</button>
        <button id="btnRestartRealm" class="btn warn">Restart Realm ‚Üª</button>
        <button id="btnNextRealm" class="btn">Next Realm ‚ûú</button>
        <button id="btnReturnToMenu" class="btn ghost">Return to Menu üè†</button>
      </div>

      <div class="opts">
        <label class="opt">
          <input id="chkScreenShake" type="checkbox" checked />
          <span>Screen shake</span>
        </label>
        <label class="opt">
          <input id="chkParticles" type="checkbox" checked />
          <span>Particles</span>
        </label>
        <label class="opt">
          <input id="chkAssist" type="checkbox" />
          <span>Assist (slower platform break)</span>
        </label>
      </div>

      <div class="subgrid">
        <button id="btnOpenUpgrades" class="btn ghost" onclick="document.getElementById('upgradePanel')?.classList.remove('hidden')">Open Upgrades ‚¨Ü</button>
      </div>
    </div>
  </div>

  <!-- Upgrade Panel -->
  <div id="upgradePanel" class="overlay hidden" role="dialog" aria-modal="true" aria-labelledby="upTitle">
    <div class="panel">
      <div class="row between">
        <h2 id="upTitle">Upgrades</h2>
        <button class="btn ghost" onclick="document.getElementById('upgradePanel').classList.add('hidden')">Close ‚úï</button>
      </div>
      <div id="upgradeList" class="list"></div>
    </div>
  </div>

  <!-- Event Log -->
  <div id="logWrap" class="ui logwrap hidden">
    <div class="row between">
      <strong>Event Log</strong>
      <button class="btn ghost" id="btnClearLog">Clear</button>
    </div>
    <div id="log" class="log"></div>
  </div>

  <!-- Leaderboard Panel -->
  <div id="leaderboardPanel" class="overlay hidden" role="dialog" aria-modal="true" aria-labelledby="leaderboardTitle">
    <div class="panel">
      <div class="row between">
        <h2 id="leaderboardTitle">Leaderboards</h2>
        <button class="btn ghost" onclick="document.getElementById('leaderboardPanel').classList.add('hidden')">Close ‚úï</button>
      </div>
      <div class="leaderboard-tabs">
        <button class="btn ghost active" data-leaderboard="overall">Overall</button>
        <button class="btn ghost" data-leaderboard="weekly">Weekly</button>
        <button class="btn ghost" data-leaderboard="daily">Daily</button>
        <button class="btn ghost" data-leaderboard="bosses">Bosses</button>
      </div>
      <div id="leaderboard" class="leaderboard-list"></div>
    </div>
  </div>

  <!-- Toast notifications -->
  <div id="toast" class="toast"></div>

  <!-- Socket.IO for online multiplayer -->
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  
  <script type="module" src="./js/boot.js"></script>
  
  <!-- Emergency button fix script -->
  <script>
    console.log('Emergency script loaded');
    
    // Test canvas pointer events immediately
    const canvas = document.getElementById('game');
    if (canvas) {
      const canvasStyle = window.getComputedStyle(canvas);
      console.log('Canvas pointer-events:', canvasStyle.pointerEvents);
      console.log('Canvas z-index:', canvasStyle.zIndex);
    }
    
    // Wait for everything to load
    window.addEventListener('load', () => {
      console.log('Window loaded, setting up emergency handlers');
      
      // Test if we can find buttons
      const startBtn = document.getElementById('btnStartGame');
      const pauseBtn = document.getElementById('btnPause');
      
      console.log('Start button:', startBtn);
      console.log('Pause button:', pauseBtn);
      
      // Check computed styles
      if (startBtn) {
        const style = window.getComputedStyle(startBtn);
        console.log('Start button pointer-events:', style.pointerEvents);
        console.log('Start button z-index:', style.zIndex);
        startBtn.style.outline = '3px solid red';
        startBtn.style.position = 'relative';
        startBtn.style.zIndex = '99999';
      }
      
      if (pauseBtn) {
        const style = window.getComputedStyle(pauseBtn);
        console.log('Pause button pointer-events:', style.pointerEvents);
        console.log('Pause button z-index:', style.zIndex);
        pauseBtn.style.outline = '3px solid green';
        pauseBtn.style.position = 'relative';
        pauseBtn.style.zIndex = '99999';
      }
      
      // Check menu z-index
      const menu = document.getElementById('menu');
      if (menu) {
        const menuStyle = window.getComputedStyle(menu);
        console.log('Menu z-index:', menuStyle.zIndex);
        console.log('Menu pointer-events:', menuStyle.pointerEvents);
      }
    });
  </script>
</body>
</html>
